function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{"ct+p":function(t,e,n){"use strict";n.r(e),n.d(e,"HomePageModule",(function(){return M}));var o=n("ofXK"),i=n("3Pt+"),r=n("TEn/"),a=n("tyNb"),c=n("mrSG"),s=n("fXoL"),l=n("tnAE"),u=n("e8h1"),h=n("Bfh1"),b=n("m/P+"),d=n("pxUr");function g(t,e){if(1&t){var n=s.Ob();s.Nb(0,"agm-marker",13),s.Vb("markerClick",(function(t){s.dc(n);var o=e.$implicit;return s.Xb().markerClick(t,o)})),s.Mb()}if(2&t){var o=e.$implicit;s.ac("latitude",o.latitude)("longitude",o.longitude)}}function f(t,e){if(1&t){var n=s.Ob();s.Nb(0,"ion-card",10),s.Nb(1,"ion-card-header"),s.Nb(2,"ion-card-title"),s.Nb(3,"button",14),s.Nb(4,"b"),s.ic(5,"X"),s.Mb(),s.Mb(),s.Mb(),s.Mb(),s.Nb(6,"ion-button",3),s.Vb("click",(function(){return s.dc(n),s.Xb().help()})),s.ic(7,"\u0e19\u0e33\u0e17\u0e32\u0e07"),s.Mb(),s.Mb()}}var p,v,m,k=[{path:"",component:(p=function(){function t(e,n,o,i,r,a,c,s){var l=this;_classCallCheck(this,t),this.loadingCtrl=e,this.toastCtrl=n,this.platform=o,this.rest=i,this.storage=r,this.geolocation=a,this.alertCtrl=c,this.iab=s,this.SOS=!1,this.SOSHelp=!1,this.count=1,this.role=1,this.first=!0,this.step=1,this.alldevice=[],this.alldeviceList=[],this.height="100%",this.zoom=13,this.currentLat=13.7601366,this.currentLng=100.5659859,this.getAllDevices(),this.storage.get("userId").then((function(t){l.userData=t,console.log(t),"V"===t.userType&&setTimeout((function(){}),3e4)}))}return _createClass(t,[{key:"presentAlert",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e,n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.alertCtrl.create({header:"\u0e41\u0e08\u0e49\u0e07\u0e40\u0e15\u0e37\u0e2d\u0e19\u0e40\u0e2b\u0e15\u0e38\u0e09\u0e38\u0e01\u0e40\u0e09\u0e34\u0e19",message:"\u0e01\u0e14\u0e40\u0e1e\u0e37\u0e48\u0e2d\u0e19\u0e33\u0e17\u0e32\u0e07",buttons:[{text:"\u0e22\u0e01\u0e40\u0e25\u0e34\u0e01",role:"cancel",handler:function(){console.log("Cancel clicked")}},{text:"\u0e19\u0e33\u0e17\u0e32\u0e07",handler:function(){n.iab.create("https://www.google.com/maps/search/?api=1&query=13.8601816,100.5128416")}}]});case 2:return e=t.sent,t.next=5,e.present();case 5:case"end":return t.stop()}}),t,this)})))}},{key:"ngOnInit",value:function(){}},{key:"getAllDevices",value:function(){var t=this;console.log("get device"),this.rest.getDeviceAll().then((function(e){console.log(e),t.alldevice=e,t.loadMap()}))}},{key:"loadMap",value:function(){var t=this;this.geolocation.getCurrentPosition().then((function(e){console.log(e),t.lat=e.coords.latitude,t.lng=e.coords.longitude,t.currentLat=e.coords.latitude,t.currentLng=e.coords.longitude,new google.maps.LatLng(e.coords.latitude,e.coords.longitude),t.addMarkersToMap()})).catch((function(t){console.log("Error getting location",t)}))}},{key:"addMarkersToMap",value:function(){var t=this;this.alldevice.forEach((function(e){var n=new google.maps.LatLng(t.currentLat,t.currentLng),o=new google.maps.LatLng(e.latitude,e.longitude),i=google.maps.geometry.spherical.computeDistanceBetween(n,o);console.log((i/1e3).toFixed(2));var r=(i/1e3).toFixed(2);parseInt(r)<=5&&t.alldeviceList.push(e)}))}},{key:"sos",value:function(){3===this.count?(this.SOS=!this.SOS,this.count++,this.createEvent()):4===this.count?(this.SOS=!this.SOS,this.count=1):this.count++,this.AEDLocation="\u0e41\u0e08\u0e49\u0e07\u0e40\u0e15\u0e37\u0e2d\u0e19\u0e44\u0e1b\u0e22\u0e31\u0e07\u0e1c\u0e39\u0e49\u0e0a\u0e48\u0e27\u0e22\u0e41\u0e25\u0e49\u0e27!!"}},{key:"createEvent",value:function(){console.log("get device"),this.rest.createEvent(this.userData.userId,this.currentLat+"/"+this.currentLng).then((function(t){console.log(t)}))}},{key:"getAllEvent",value:function(){this.rest.getEventAll().then((function(t){console.log(t)}))}},{key:"showToast",value:function(t){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.toastCtrl.create({message:t,duration:2e3,position:"middle"});case 2:e.sent.present();case 3:case"end":return e.stop()}}),e,this)})))}},{key:"nextStep",value:function(){this.step+=1,3===this.step&&(this.step=void 0)}},{key:"notificationPop",value:function(){this.SOSHelp=!0,this.step=3}},{key:"help",value:function(){window.open("https://maps.google.com/?q=13.7551,100.4984","_system"),this.SOSHelp=!1,this.step=1}},{key:"markerClick",value:function(t,e){this.presentConfirm(e)}},{key:"presentConfirm",value:function(t){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alertCtrl.create({header:t.deviceLocationName,message:t.deviceMark,buttons:[{text:"\u0e22\u0e01\u0e40\u0e25\u0e34\u0e01",role:"cancel",handler:function(){console.log("Cancel clicked")}},{text:"\u0e19\u0e33\u0e17\u0e32\u0e07",handler:function(){o.iab.create("https://www.google.com/maps/search/?api=1&query="+t.latitude+", "+t.longitude)}}]});case 2:return n=e.sent,e.next=5,n.present();case 5:case"end":return e.stop()}}),e,this)})))}}]),t}(),p.\u0275fac=function(t){return new(t||p)(s.Kb(r.L),s.Kb(r.T),s.Kb(r.O),s.Kb(l.a),s.Kb(u.b),s.Kb(h.a),s.Kb(r.a),s.Kb(b.a))},p.\u0275cmp=s.Eb({type:p,selectors:[["app-home"]],decls:31,vars:18,consts:[[1,"header"],["slot","start"],["slot","end"],[3,"click"],["padding","",2,"width","100vw","height","100vh","overflow","hidden"],[3,"latitude","longitude","zoom"],[3,"latitude","longitude","markerClick",4,"ngFor","ngForOf"],["vertical","center","horizontal","center",2,"margin-top","30vh"],["color","danger",2,"right","0","width","20vw","height","10vh",3,"click"],["name","heart"],[2,"background-color","white !important","margin-left","-5vw","margin-top","75vh","width","100vw","height","16vh","position","fixed"],[2,"float","right","background-color","transparent",3,"click"],["style","background-color:white !important;margin-left: -5vw;margin-top:75vh;width: 100vw;height:16vh;position: fixed;",4,"ngIf"],[3,"latitude","longitude","markerClick"],[2,"float","right","background-color","transparent"]],template:function(t,e){1&t&&(s.Nb(0,"ion-header"),s.Nb(1,"ion-toolbar",0),s.Nb(2,"ion-buttons",1),s.Lb(3,"ion-menu-button"),s.Mb(),s.Nb(4,"ion-title"),s.ic(5," Home "),s.Mb(),s.Nb(6,"ion-buttons",2),s.Nb(7,"ion-button",3),s.Vb("click",(function(){return e.notificationPop()})),s.ic(8,"\u0e01\u0e32\u0e23\u0e41\u0e08\u0e49\u0e07\u0e40\u0e15\u0e37\u0e2d\u0e19"),s.Mb(),s.Mb(),s.Mb(),s.Mb(),s.Nb(9,"ion-content",4),s.Nb(10,"agm-map",5),s.hc(11,g,1,2,"agm-marker",6),s.Mb(),s.Nb(12,"ion-fab",7),s.Nb(13,"ion-fab-button",8),s.Vb("click",(function(){return e.sos()})),s.Nb(14,"ion-grid"),s.Nb(15,"ion-row"),s.Nb(16,"ion-col"),s.Lb(17,"ion-icon",9),s.Mb(),s.Mb(),s.Nb(18,"ion-row"),s.Nb(19,"ion-col"),s.Nb(20,"b"),s.ic(21,"SOS"),s.Mb(),s.Mb(),s.Mb(),s.Mb(),s.Mb(),s.Mb(),s.Nb(22,"ion-card",10),s.Nb(23,"ion-card-header"),s.Nb(24,"ion-card-title"),s.Nb(25,"button",11),s.Vb("click",(function(){return e.sos()})),s.Nb(26,"b"),s.ic(27,"X"),s.Mb(),s.Mb(),s.Mb(),s.Nb(28,"ion-card-subtitle"),s.ic(29),s.Mb(),s.Mb(),s.Mb(),s.hc(30,f,8,0,"ion-card",12),s.Mb()),2&t&&(s.gc("z-index",1===e.step?"100000":"10"),s.Ab(10),s.gc("height",e.height),s.ac("latitude",e.currentLat)("longitude",e.currentLng)("zoom",e.zoom),s.Ab(1),s.ac("ngForOf",e.alldeviceList),s.Ab(1),s.gc("z-index",2===e.step?"100000":"10")("opacity",e.SOS?"0":"1")("display",2===e.role?"none":""),s.Ab(10),s.gc("opacity",e.SOS?"1":"0"),s.Ab(7),s.jc(e.AEDLocation),s.Ab(1),s.ac("ngIf",e.SOSHelp))},directives:[r.p,r.I,r.e,r.x,r.H,r.d,r.k,d.b,o.h,r.m,r.n,r.o,r.C,r.j,r.q,r.f,r.g,r.i,r.h,o.i,d.c],styles:[".welcome-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:35vh;overflow:hidden}.header[_ngcontent-%COMP%]{color:#fff;background:brown;--background:brown;font-family:Kanit,sans-serif!important}"]}),p)}],w=((m=function t(){_classCallCheck(this,t)}).\u0275mod=s.Ib({type:m}),m.\u0275inj=s.Hb({factory:function(t){return new(t||m)},imports:[[a.i.forChild(k)],a.i]}),m),M=((v=function t(){_classCallCheck(this,t)}).\u0275mod=s.Ib({type:v}),v.\u0275inj=s.Hb({factory:function(t){return new(t||v)},imports:[[o.b,i.a,r.J,w,d.a]]}),v)}}]);