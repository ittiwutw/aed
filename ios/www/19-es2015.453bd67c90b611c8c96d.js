(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{"ct+p":function(t,e,i){"use strict";i.r(e),i.d(e,"HomePageModule",(function(){return v}));var o=i("ofXK"),n=i("3Pt+"),r=i("TEn/"),c=i("tyNb"),s=i("mrSG"),a=i("fXoL"),l=i("tnAE"),b=i("e8h1"),h=i("Bfh1"),d=i("m/P+"),g=i("pxUr");function u(t,e){if(1&t){const t=a.Ob();a.Nb(0,"agm-marker",20),a.Vb("markerClick",(function(i){a.dc(t);const o=e.$implicit;return a.Xb().markerClick(i,o)})),a.Mb()}if(2&t){const t=e.$implicit;a.ac("latitude",t.latitude)("longitude",t.longitude)}}function p(t,e){if(1&t){const t=a.Ob();a.Nb(0,"ion-card",17),a.Nb(1,"ion-card-header"),a.Nb(2,"ion-card-title"),a.Nb(3,"button",21),a.Nb(4,"b"),a.ic(5,"X"),a.Mb(),a.Mb(),a.Mb(),a.Mb(),a.Nb(6,"ion-button",3),a.Vb("click",(function(){return a.dc(t),a.Xb().help()})),a.ic(7,"\u0e19\u0e33\u0e17\u0e32\u0e07"),a.Mb(),a.Mb()}}const m=[{path:"",component:(()=>{class t{constructor(t,e,i,o,n,r,c,s){this.loadingCtrl=t,this.toastCtrl=e,this.platform=i,this.rest=o,this.storage=n,this.geolocation=r,this.alertCtrl=c,this.iab=s,this.SOS=!1,this.SOSHelp=!1,this.count=1,this.role=1,this.first=!0,this.step=1,this.alldevice=[],this.alldeviceList=[],this.height="100%",this.zoom=13,this.currentLat=13.7601366,this.currentLng=100.5659859,this.getAllDevices(),this.storage.get("userId").then(t=>{this.userData=t,console.log(t),"V"===t.userType&&setTimeout(()=>{this.presentAlert()},3e4)})}presentAlert(){return Object(s.a)(this,void 0,void 0,(function*(){const t=yield this.alertCtrl.create({header:"\u0e41\u0e08\u0e49\u0e07\u0e40\u0e15\u0e37\u0e2d\u0e19\u0e40\u0e2b\u0e15\u0e38\u0e09\u0e38\u0e01\u0e40\u0e09\u0e34\u0e19",message:"\u0e01\u0e14\u0e40\u0e1e\u0e37\u0e48\u0e2d\u0e19\u0e33\u0e17\u0e32\u0e07",buttons:[{text:"\u0e22\u0e01\u0e40\u0e25\u0e34\u0e01",role:"cancel",handler:()=>{console.log("Cancel clicked")}},{text:"\u0e19\u0e33\u0e17\u0e32\u0e07",handler:()=>{this.iab.create("https://www.google.com/maps/search/?api=1&query=13.8601816,100.5128416")}}]});yield t.present()}))}ngOnInit(){}getAllDevices(){console.log("get device"),this.rest.getDeviceAll().then(t=>{console.log(t),this.alldevice=t,this.loadMap()})}loadMap(){this.geolocation.getCurrentPosition().then(t=>{console.log(t),this.lat=t.coords.latitude,this.lng=t.coords.longitude,this.currentLat=t.coords.latitude,this.currentLng=t.coords.longitude,new google.maps.LatLng(t.coords.latitude,t.coords.longitude),this.addMarkersToMap()}).catch(t=>{console.log("Error getting location",t)})}addMarkersToMap(){this.alldevice.forEach(t=>{const e=new google.maps.LatLng(this.currentLat,this.currentLng),i=new google.maps.LatLng(t.latitude,t.longitude),o=google.maps.geometry.spherical.computeDistanceBetween(e,i);console.log((o/1e3).toFixed(2));const n=(o/1e3).toFixed(2);parseInt(n)<=5&&this.alldeviceList.push(t)})}sos(){3===this.count?(this.SOS=!this.SOS,this.count++,this.createEvent()):4===this.count?(this.SOS=!this.SOS,this.count=1):this.count++,this.AEDLocation="\u0e41\u0e08\u0e49\u0e07\u0e40\u0e15\u0e37\u0e2d\u0e19\u0e44\u0e1b\u0e22\u0e31\u0e07\u0e1c\u0e39\u0e49\u0e0a\u0e48\u0e27\u0e22\u0e41\u0e25\u0e49\u0e27!!"}createEvent(){console.log("get device"),this.rest.createEvent(this.userData.userId,this.currentLat+"/"+this.currentLng).then(t=>{console.log(t)})}getAllEvent(){this.rest.getEventAll().then(t=>{console.log(t)})}showToast(t){return Object(s.a)(this,void 0,void 0,(function*(){(yield this.toastCtrl.create({message:t,duration:2e3,position:"middle"})).present()}))}nextStep(){this.step+=1,3===this.step&&(this.step=void 0)}notificationPop(){this.SOSHelp=!0,this.step=3}help(){window.open("https://maps.google.com/?q=13.7551,100.4984","_system"),this.SOSHelp=!1,this.step=1}markerClick(t,e){this.presentConfirm(e)}presentConfirm(t){return Object(s.a)(this,void 0,void 0,(function*(){const e=yield this.alertCtrl.create({header:t.deviceLocationName,message:t.deviceMark,buttons:[{text:"\u0e22\u0e01\u0e40\u0e25\u0e34\u0e01",role:"cancel",handler:()=>{console.log("Cancel clicked")}},{text:"\u0e19\u0e33\u0e17\u0e32\u0e07",handler:()=>{this.iab.create("https://www.google.com/maps/search/?api=1&query="+t.latitude+", "+t.longitude)}}]});yield e.present()}))}}return t.\u0275fac=function(e){return new(e||t)(a.Kb(r.L),a.Kb(r.T),a.Kb(r.O),a.Kb(l.a),a.Kb(b.b),a.Kb(h.a),a.Kb(r.a),a.Kb(d.a))},t.\u0275cmp=a.Eb({type:t,selectors:[["app-home"]],decls:45,vars:29,consts:[[1,"header"],["slot","start"],["slot","end"],[3,"click"],[2,"color","white","z-index","10000","position","absolute","background-color","black","height","100vh","width","100vw","opacity","0.5"],["align","center",2,"margin-top","7vh","margin-left","-86vw"],["name","arrow-up"],["align","center",2,"margin-top","73vh","margin-left","5vw"],["name","arrow-down"],["padding","",2,"width","100vw","height","100vh","overflow","hidden"],[3,"latitude","longitude","zoom"],[3,"latitude","longitude","markerClick",4,"ngFor","ngForOf"],["vertical","center","horizontal","end","slot","fixed",2,"--background","transparent"],[2,"--background","transparent","--box-shadow","none",3,"click"],["vertical","center","horizontal","center",2,"margin-top","30vh"],["color","danger",2,"right","0","width","20vw","height","10vh",3,"click"],["name","heart"],[2,"background-color","white !important","margin-left","-5vw","margin-top","75vh","width","100vw","height","16vh","position","fixed"],[2,"float","right","background-color","transparent",3,"click"],["style","background-color:white !important;margin-left: -5vw;margin-top:75vh;width: 100vw;height:16vh;position: fixed;",4,"ngIf"],[3,"latitude","longitude","markerClick"],[2,"float","right","background-color","transparent"]],template:function(t,e){1&t&&(a.Nb(0,"ion-header"),a.Nb(1,"ion-toolbar",0),a.Nb(2,"ion-buttons",1),a.Lb(3,"ion-menu-button"),a.Mb(),a.Nb(4,"ion-title"),a.ic(5," Home "),a.Mb(),a.Nb(6,"ion-buttons",2),a.Nb(7,"ion-button",3),a.Vb("click",(function(){return e.notificationPop()})),a.ic(8,"\u0e01\u0e32\u0e23\u0e41\u0e08\u0e49\u0e07\u0e40\u0e15\u0e37\u0e2d\u0e19"),a.Mb(),a.Mb(),a.Mb(),a.Mb(),a.Nb(9,"div",4),a.Nb(10,"div",5),a.Nb(11,"p"),a.Lb(12,"ion-icon",6),a.Mb(),a.Nb(13,"p"),a.ic(14,"\u0e40\u0e21\u0e19\u0e39"),a.Mb(),a.Mb(),a.Nb(15,"div",7),a.Nb(16,"p"),a.ic(17,"\u0e01\u0e14 3 \u0e04\u0e23\u0e31\u0e49\u0e07 \u0e40\u0e1e\u0e37\u0e48\u0e2d\u0e02\u0e2d\u0e04\u0e27\u0e32\u0e21\u0e0a\u0e48\u0e27\u0e22\u0e40\u0e2b\u0e25\u0e37\u0e2d"),a.Mb(),a.Nb(18,"p"),a.Lb(19,"ion-icon",8),a.Mb(),a.Mb(),a.Mb(),a.Nb(20,"ion-content",9),a.Nb(21,"agm-map",10),a.hc(22,u,1,2,"agm-marker",11),a.Mb(),a.Nb(23,"ion-fab",12),a.Nb(24,"ion-button",13),a.Vb("click",(function(){return e.nextStep()})),a.ic(25),a.Mb(),a.Mb(),a.Nb(26,"ion-fab",14),a.Nb(27,"ion-fab-button",15),a.Vb("click",(function(){return e.sos()})),a.Nb(28,"ion-grid"),a.Nb(29,"ion-row"),a.Nb(30,"ion-col"),a.Lb(31,"ion-icon",16),a.Mb(),a.Mb(),a.Nb(32,"ion-row"),a.Nb(33,"ion-col"),a.Nb(34,"b"),a.ic(35,"SOS"),a.Mb(),a.Mb(),a.Mb(),a.Mb(),a.Mb(),a.Mb(),a.Nb(36,"ion-card",17),a.Nb(37,"ion-card-header"),a.Nb(38,"ion-card-title"),a.Nb(39,"button",18),a.Vb("click",(function(){return e.sos()})),a.Nb(40,"b"),a.ic(41,"X"),a.Mb(),a.Mb(),a.Mb(),a.Nb(42,"ion-card-subtitle"),a.ic(43),a.Mb(),a.Mb(),a.Mb(),a.hc(44,p,8,0,"ion-card",19),a.Mb()),2&t&&(a.gc("z-index",1===e.step?"100000":"10"),a.Ab(9),a.gc("display",e.first&&void 0!==e.step?"":"none"),a.Ab(1),a.gc("display",1===e.step?"":"none"),a.Ab(5),a.gc("display",2===e.step?"":"none"),a.Ab(6),a.gc("height",e.height),a.ac("latitude",e.currentLat)("longitude",e.currentLng)("zoom",e.zoom),a.Ab(1),a.ac("ngForOf",e.alldeviceList),a.Ab(1),a.gc("display",void 0!==e.step?"":"none")("z-index",e.step?"100000":"10"),a.Ab(2),a.kc(" ",1==e.step?"\u0e02\u0e49\u0e32\u0e21 >>>":"\u0e40\u0e2a\u0e23\u0e47\u0e08\u0e2a\u0e34\u0e49\u0e19 >>>"," "),a.Ab(1),a.gc("z-index",2===e.step?"100000":"10")("opacity",e.SOS?"0":"1")("display",2===e.role?"none":""),a.Ab(10),a.gc("opacity",e.SOS?"1":"0"),a.Ab(7),a.jc(e.AEDLocation),a.Ab(1),a.ac("ngIf",e.SOSHelp))},directives:[r.p,r.I,r.e,r.x,r.H,r.d,r.q,r.k,g.b,o.h,r.m,r.n,r.o,r.C,r.j,r.f,r.g,r.i,r.h,o.i,g.c],styles:[".welcome-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:35vh;overflow:hidden}.header[_ngcontent-%COMP%]{color:#fff;background:brown;--background:brown;font-family:Kanit,sans-serif!important}"]}),t})()}];let f=(()=>{class t{}return t.\u0275mod=a.Ib({type:t}),t.\u0275inj=a.Hb({factory:function(e){return new(e||t)},imports:[[c.i.forChild(m)],c.i]}),t})(),v=(()=>{class t{}return t.\u0275mod=a.Ib({type:t}),t.\u0275inj=a.Hb({factory:function(e){return new(e||t)},imports:[[o.b,n.a,r.J,f,g.a]]}),t})()}}]);